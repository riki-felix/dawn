{% comment %}
  Sección: Banner de acceso (modal universal)
  Uso: Solo en el header. Modal bloqueante con imagen, botón de cerrar, y dos botones adicionales.
{% endcomment %}

<style>
  #modal-banner-{{ section.id }} {
	position: fixed;
	top: 0; left: 0;
	width: 100vw;
	height: 100vh;
	z-index: 99999;
	display: flex;
	align-items: center;
	justify-content: center;
  }

  #modal-banner-{{ section.id }}.hidden {
	display: none;
  }

  .modal-banner__overlay {
	position: absolute;
	inset: 0;
	background-color: rgba(var(--color-background), {{ section.settings.overlay_opacity | divided_by: 100.0 }});
	pointer-events: auto;
  }

  .modal-banner__content {
	position: relative;
	background-color: rgb(var(--color-background));
	color: rgb(var(--color-foreground));
	padding: 2rem 0 ;
	max-width: 700px;
	width: 90%;
	z-index: 100000;
	border-radius: 0.5rem;
	border: var(--page-border);
  }

  .modal-banner__image {
	max-width: 100%;
	height: auto;
	margin-bottom: 1rem;
	border-radius: 0.25rem;
	border-bottom: var(--page-border);
  }

  .modal-banner__buttons {
	display: flex;
	flex-direction: row wrap;
	justify-content: space-between;
	gap: 3rem;
	padding: 2.0rem;
  }
  .buttons-group {
	  display: flex;
	  flex-flow: row wrap;
	  justify-content: space-between;
	  gap: 2rem;
  }

  .modal-banner__block .modal-banner__text {
	margin-bottom: 0.5rem;
  }

  .modal-banner__action {
	background-color: transparent;
	color: rgb(var(--color-button-outline));
	padding: 0.75rem 1rem;
	text-decoration: none;
	border: 0;
	border-radius: 0.25rem;
	border: 1px solid rgb(var(--color-secondary-button-text));
	display: inline-block;
	font-size: 1.6rem;
	font-family: var(--font-body-family);
  }
  .modal-banner__close {
	background-color: rgb(var(--color-button));
	color: rgb(var(--color-button-text));
	cursor: pointer;
  }

  .modal-banner__action:hover {
	opacity: 0.9;
  }
</style>

<div id="modal-banner-{{ section.id }}" class="modal-banner__wrapper{% unless section.settings.enable_modal %} hidden{% endunless %}">
  <div
	class="modal-banner__overlay"
	style="
	  background-color: rgba(var(--color-background), {{ section.settings.overlay_opacity | divided_by: 100.0 }});
	  backdrop-filter: blur({{ section.settings.overlay_blur }}px);
	  -webkit-backdrop-filter: blur({{ section.settings.overlay_blur }}px);
	">
  </div>
  <div class="modal-banner__content color-{{ section.settings.color_scheme }}">
	{% if section.settings.header_image %}
	  <img
		src="{{ section.settings.header_image | image_url: width: 800 }}"
		alt="Modal image"
		class="modal-banner__image"
		loading="lazy"
		width="100%"
		height="auto"
	  >
	{% endif %}

	<div class="modal-banner__buttons">
	  <div class="banner-access_main">
	  <h3 class="banner-access_heading">PAÍS VASCO</h3>
		<button class="modal-banner__close modal-banner__action" onclick="closeBannerModal()" aria-label="Cerrar">
			{{ section.settings.close_button_label }}
		</button>
	  </div>
	  <div class="banner-access_secondary">
	  	<h3 class="banner-access_heading">MADRID</h3>
		  <div class="buttons-group">
			{% for block in section.blocks %}
				<div class="modal-banner__block">
					<a href="{{ block.settings.link }}" class="modal-banner__action">
						{{ block.settings.label | raw }}
					</a>
					{% if block.settings.text %}
						<p class="modal-banner__text">{{ block.settings.text }}</p>
					{% endif %}
				</div>
			{% endfor %}
		  </div>
	  </div>
	</div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
	const modal = document.getElementById("modal-banner-{{ section.id }}");

	if (localStorage.getItem("modalClosed-{{ section.id }}")) {
	  modal.classList.add("hidden");
	}
  });

  function closeBannerModal() {
	const modal = document.getElementById("modal-banner-{{ section.id }}");
	modal.classList.add("hidden");
	localStorage.setItem("modalClosed-{{ section.id }}", "true");
  }
</script>

{% schema %}
{
  "name": "Banner de acceso",
  "tag": "header",
  "enabled_on": {
	"groups": ["header"]
  },
  "settings": [
	{
	  "type": "checkbox",
	  "id": "enable_modal",
	  "label": "Activar banner modal",
	  "default": true
	},
	{
	  "type": "image_picker",
	  "id": "header_image",
	  "label": "Imagen de cabecera"
	},
	{
	  "type": "text",
	  "id": "close_button_label",
	  "label": "Texto del botón de cierre",
	  "default": "Cerrar"
	},
	{
	  "type": "color_scheme",
	  "id": "color_scheme",
	  "label": "Esquema de color",
	  "default": "background-1"
	},
	{
	  "type": "range",
	  "id": "overlay_opacity",
	  "label": "Opacidad del fondo",
	  "min": 0,
	  "max": 100,
	  "step": 5,
	  "default": 60,
	  "unit": "%"
	},
	{
	  "type": "range",
	  "id": "overlay_blur",
	  "label": "Desenfoque del fondo (blur)",
	  "min": 0,
	  "max": 20,
	  "step": 1,
	  "default": 4,
	  "unit": "px"
	}
  ],
  "blocks": [
	{
	  "type": "button",
	  "name": "Botón de acción",
	  "settings": [
		{
		  "type": "text",
		  "id": "text",
		  "label": "Texto antes del botón"
		},
		{
		  "type": "text",
		  "id": "label",
		  "label": "Texto del botón",
		  "default": "Más información"
		},
		{
		  "type": "url",
		  "id": "link",
		  "label": "Enlace del botón"
		}
	  ]
	}
  ],
  "max_blocks": 2,
  "presets": [
	{
	  "name": "Banner de acceso"
	}
  ]
}
{% endschema %}